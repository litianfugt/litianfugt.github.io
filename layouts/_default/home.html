{{- define "main" }}

{{- if (and site.Params.profileMode.enabled .IsHome) }}
{{- partial "index_profile.html" . }}
{{- else }} {{/* if not profileMode */}}

{{- if not .IsHome | and .Title }}
<header class="page-header">
  {{- partial "breadcrumbs.html" . }}
  <h1>
    {{ .Title }}
    {{- if and (or (eq .Kind `term`) (eq .Kind `section`)) (.Param "ShowRssButtonInSectionTermList") }}
    {{- with .OutputFormats.Get "rss" }}
    <a href="{{ .RelPermalink }}" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
    {{- end }}
    {{- end }}
  </h1>
  {{- if .Description }}
  <div class="post-description">
    {{ .Description | markdownify }}
  </div>
  {{- end }}
</header>
{{- end }}

{{- if .Content }}
<div class="post-content">
  {{- if not (.Param "disableAnchoredHeadings") }}
  {{- partial "anchored_headings.html" .Content -}}
  {{- else }}{{ .Content }}{{ end }}
</div>
{{- end }}

{{- if and .IsHome site.Params.homeInfoParams }}
{{- partial "home_info.html" . }}
{{- end }}

<div class="modern-home">
  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <div class="main-content">
    <!-- å·¦ä¾§ï¼šæ–‡ç« å’Œéšæƒ³ -->
    <div class="content-primary">
      <!-- æ–‡ç« åŒºåŸŸ -->
      <section class="content-section">
        <div class="section-header">
          <h2 class="section-title">
            <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            æœ€æ–°æ–‡ç« 
          </h2>
          <a href="/posts/" class="section-more">æŸ¥çœ‹å…¨éƒ¨ â†’</a>
        </div>
        <div class="articles-grid">
          {{- $posts := where site.RegularPages "Type" "in" "posts" }}
          {{- $posts = where $posts "Params.hiddenInHomeList" "!=" "true" }}
          {{- range first 4 $posts.ByDate.Reverse }}
          <article class="article-item">
            <div class="article-meta">
              <time class="article-date">{{ .Date.Format "2006.01.02" }}</time>
              {{- if .Draft }}<span class="article-badge draft">è‰ç¨¿</span>{{ end }}
            </div>
            <h3 class="article-title">
              <a href="{{ .Permalink }}">{{ .Title }}</a>
            </h3>
            {{- if (ne (.Param "hideSummary") true) }}
            <p class="article-excerpt">{{ .Summary | plainify | htmlUnescape | truncate 50 }}</p>
            {{- end }}
            <div class="article-footer">
              <span class="article-read-time">{{ .ReadingTime }} min</span>
              <a href="{{ .Permalink }}" class="article-link">é˜…è¯» â†’</a>
            </div>
          </article>
          {{- end }}
        </div>
      </section>

      <!-- éšæƒ³åŒºåŸŸ -->
      <section class="content-section">
        <div class="section-header">
          <h2 class="section-title">
            <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
            </svg>
            æœ€è¿‘éšæƒ³
          </h2>
          <a href="/thoughts/" class="section-more">æŸ¥çœ‹å…¨éƒ¨ â†’</a>
        </div>
        <div class="thoughts-list">
          {{- $thoughts := where site.RegularPages "Type" "in" "thoughts" }}
          {{- range first 3 $thoughts.ByDate.Reverse }}
          <article class="thought-item">
            <div class="thought-header">
              <div class="thought-avatar">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/>
                </svg>
              </div>
              <div class="thought-info">
                <div class="thought-author">{{ .Site.Author.name | default "æçŸ³åŸ" }}</div>
                <time class="thought-time">{{ .Date.Format "15:04" }}</time>
              </div>
              <span class="thought-date">{{ .Date.Format "01/02" }}</span>
            </div>
            <div class="thought-content">
              <a href="{{ .Permalink }}" class="thought-text">{{ .Content | plainify | truncate 40 }}</a>
            </div>
          </article>
          {{- end }}
        </div>
      </section>
    </div>

    <!-- å³ä¾§ï¼šä¾§è¾¹æ  -->
    <aside class="content-sidebar">
      <!-- å¿«é€Ÿå¯¼èˆª -->
      <section class="sidebar-section">
        <h3 class="sidebar-title">å¿«é€Ÿå¯¼èˆª</h3>
        <nav class="sidebar-nav">
          <a href="/posts/" class="sidebar-link">
            <span class="sidebar-icon">ğŸ“š</span>
            <span class="sidebar-text">æŠ€æœ¯æ–‡ç« </span>
          </a>
          <a href="/thoughts/" class="sidebar-link">
            <span class="sidebar-icon">ğŸ’­</span>
            <span class="sidebar-text">éšæƒ³ç¬”è®°</span>
          </a>
          <a href="/archives/" class="sidebar-link">
            <span class="sidebar-icon">ğŸ—ƒï¸</span>
            <span class="sidebar-text">æ–‡ç« å½’æ¡£</span>
          </a>
          <a href="/categories/" class="sidebar-link">
            <span class="sidebar-icon">ğŸ·ï¸</span>
            <span class="sidebar-text">åˆ†ç±»æµè§ˆ</span>
          </a>
          <a href="/search/" class="sidebar-link">
            <span class="sidebar-icon">ğŸ”</span>
            <span class="sidebar-text">å†…å®¹æœç´¢</span>
          </a>
          <a href="/about/" class="sidebar-link">
            <span class="sidebar-icon">ğŸ‘¤</span>
            <span class="sidebar-text">å…³äºä½œè€…</span>
          </a>
        </nav>
      </section>

      <!-- ç»Ÿè®¡æ•°æ® -->
      <section class="sidebar-section">
        <h3 class="sidebar-title">åšå®¢ç»Ÿè®¡</h3>
        <div class="sidebar-stats">
          <div class="stat-item">
            <div class="stat-number">{{ len (where site.RegularPages "Type" "in" "posts") }}</div>
            <div class="stat-label">æŠ€æœ¯æ–‡ç« </div>
          </div>
          <div class="stat-item">
            <div class="stat-number">{{ len (where site.RegularPages "Type" "in" "thoughts") }}</div>
            <div class="stat-label">éšæƒ³ç¬”è®°</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">{{ now.Format "2006" }}</div>
            <div class="stat-label">å§‹äºå¹´ä»½</div>
          </div>
        </div>
      </section>
    </aside>
  </div>
</div>

{{- end }}{{/* end profileMode */}}

{{- end }}{{- /* end main */ -}}
